{"version":3,"sources":["../../src/plugins/_database.plugin.ts"],"sourcesContent":["import type { Prisma } from \"@prisma/client\"\nimport { PrismaClient } from \"@prisma/client\"\nimport type { RepositoryFactory } from \"@root/types/repsoitory-factory.type.js\"\nimport type { FastifyPluginAsync } from \"fastify\"\n\nconst plugin: FastifyPluginAsync = async self => {\n\tconst logFeatureFlag = process.env[\"LOG_QUERY\"]\n\tconst log: Prisma.LogLevel[] = [\"error\", \"warn\", \"info\"]\n\tif (logFeatureFlag) {\n\t\tlog.push(\"query\")\n\t}\n\n\tconst prisma = new PrismaClient<Prisma.PrismaClientOptions, \"query\">({\n\t\tlog,\n\t\terrorFormat: \"pretty\"\n\t})\n\n\tawait prisma.$connect()\n\n\tself.decorate(\n\t\t\"resolveRepository\",\n\t\t<T>(Factory: RepositoryFactory<T>) => new Factory(prisma)\n\t)\n}\n\nexport default plugin\n"],"names":["PrismaClient","plugin","self","logFeatureFlag","process","env","log","push","prisma","errorFormat","$connect","decorate","Factory"],"mappings":"AACA,SAASA,YAAY,QAAQ,iBAAgB;AAI7C,MAAMC,SAA6B,OAAMC;IACxC,MAAMC,iBAAiBC,QAAQC,GAAG,CAAC,YAAY;IAC/C,MAAMC,MAAyB;QAAC;QAAS;QAAQ;KAAO;IACxD,IAAIH,gBAAgB;QACnBG,IAAIC,IAAI,CAAC;IACV;IAEA,MAAMC,SAAS,IAAIR,aAAkD;QACpEM;QACAG,aAAa;IACd;IAEA,MAAMD,OAAOE,QAAQ;IAErBR,KAAKS,QAAQ,CACZ,qBACA,CAAIC,UAAkC,IAAIA,QAAQJ;AAEpD;AAEA,eAAeP,OAAM"}